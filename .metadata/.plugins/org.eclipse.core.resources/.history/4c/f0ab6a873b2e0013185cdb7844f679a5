package com.example.telpic;

import java.util.ArrayList;
import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Paint;
//import android.graphics.Paint.FontMetrics;
import android.util.AttributeSet;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnTouchListener;

class Data
{
    float x, y;
    Data (float xp, float yp)
    {
        x = xp;
        y = yp;
    }
}

public class Sketch extends View implements OnTouchListener {

    private float width;    // width of one tile
    private float height;   // height of one tile
    Paint background, translucentRedPen, bluePen;

    ArrayList<ArrayList<Data>> pointList = new ArrayList<ArrayList<Data>>();   

    private void init()
    {
        background = new Paint();
        //background.setStyle(Paint.Style.FILL_AND_STROKE);
        background.setColor(0xffcfffff);

        translucentRedPen = new Paint();
        translucentRedPen.setColor(getResources().getColor(R.color.translucentRedPen));

        bluePen = new Paint();
        bluePen.setColor(getResources().getColor(R.color.bluePen));
        bluePen.setStyle(Paint.Style.STROKE);
        bluePen.setTextSize(24);
        bluePen.setTextScaleX(.75f);
        bluePen.setTextAlign(Paint.Align.CENTER); // Try LEFT and RIGHT
    }
    
    public Sketch(Context context) {
        super(context);
        init();
    }

    public Sketch(Context context, AttributeSet attrs) {
        super(context, attrs);
        init();
    }

    public Sketch(Context context, 
            AttributeSet ats, 
            int defaultStyle) {
        super(context, ats, defaultStyle);
        init();
    }


    @Override
    protected void onDraw(Canvas canvas) {
        // Draw the background...
        width = getWidth();
        height = getHeight();
        canvas.drawRect(0, 0, width, height, background);
   
        for (int i=1; i < pointList.size(); i++)
        {	
        	ArrayList<Data> current = pointList.get(i);
        	for (int j=1; j < current.size(); j++) 
        	{
        		Data d1 = current.get(i-1);
        		Data d2 = current.get(i);
        		canvas.drawLine(d1.x, d1.y, d2.x, d2.y, bluePen);
        	}
        }

    }

    public boolean onTouch(View v, MotionEvent event) {     

        // Handle touch events here...
        float x = event.getX();
        float y = event.getY();
        String type="unknown";
        ArrayList<Data> continuousList = new ArrayList<Data>();
        switch (event.getAction() & MotionEvent.ACTION_MASK) {
        //Finger is down
        case MotionEvent.ACTION_DOWN:            
            type="DOWN ";
//            pointList.clear();
            pointList.add(ArrayList<new Data(x,y)>);
            break;
        case MotionEvent.ACTION_POINTER_DOWN:
            type="ACTION_POINTER_DOWN ";        
            break;
        case MotionEvent.ACTION_UP:
        	//finger is picked up off screen
        case MotionEvent.ACTION_POINTER_UP:
            pointList.add(new Data(x,y));                 
            type="UP";
            break;
            //finger is moving
        case MotionEvent.ACTION_MOVE:          
            type= "ACTION_MOVE";
            pointList.add(new Data(x,y));              
            break;
        }
        //Calls ondraw
        invalidate();
        return true; // indicate event was handled
    }
}